!function(t,e){"function"==typeof define&&(define.amd||define.cmd)?define(e):t.Follow=e()}(this,function(t){"function"==typeof t&&t("enhance"),$.fn.follow=function(H,t){var M={offsets:{x:0,y:0},position:"4-1",edgeAdjust:!0},W=$.extend({},M,t||{});return $(this).each(function(){var t=$(this);if(0!=H.length){var e,o,i,n,r,f,a,s=t.data("height"),c=t.data("width");s=s||t.outerHeight(),c=c||t.outerWidth();var d=$(window).scrollTop(),u=$(window).scrollLeft(),h=parseInt(W.offsets.x,10)||0,l=parseInt(W.offsets.y,10)||0,p=$(window).width(),g=$(window).height(),w=W.position;if("string"!=typeof w&&2==w.length){var b=w[0]+h,m=w[1]+l;return 1==W.edgeAdjust&&(p+u-5<b+c&&(b=p+u-5-c),g+d-5<m+s&&(m=g+d-5-s)),t.css({position:"absolute",left:b,top:m}).attr("data-align","3-1"),void(t.zIndex&&t.zIndex())}e=H.offset(),f=H.outerHeight(),a=H.outerWidth(),o=e.left,i=e.top;var v,x=W.position,k=!1;$.each(["4-1","1-4","5-7","2-3","2-1","6-8","3-4","4-3","8-6","1-2","7-5","3-2"],function(t,e){if(e===x)return!(k=!0)}),k||(x=M.position);function I(t){var e="bottom";switch(t){case"1-4":case"5-7":case"2-3":e="top";break;case"2-1":case"6-8":case"3-4":e="right";break;case"1-2":case"8-6":case"4-3":e="left";break;case"4-1":case"7-5":case"3-2":e="bottom"}return e}function y(t){return"5-7"===t||"6-8"===t||"8-6"===t||"7-5"===t}function j(t){if("right"===t){if(o+a+c+h>$(window).width())return!1}else if("bottom"===t){if(i+f+s+l>d+$(window).height())return!1}else if("top"===t){if(i-d<s+l)return!1}else if("left"===t&&o<c+h)return!1;return!0}v=I(x),W.edgeAdjust&&(j(v)?function(){if(!y(x)){var t,e={top:{right:"2-3",left:"1-4"},right:{top:"2-1",bottom:"3-4"},bottom:{right:"3-2",left:"4-1"},left:{top:"1-2",bottom:"4-3"}}[v];if(e)for(t in e)j(t)||(x=e[t])}}():function(){if(y(x)){x={"5-7":"7-5","7-5":"5-7","6-8":"8-6","8-6":"6-8"}[x]}else{var t={top:{left:"3-2",right:"4-1"},right:{bottom:"1-2",top:"4-3"},bottom:{left:"2-3",right:"1-4"},left:{bottom:"2-1",top:"3-4"}}[v],e=[];for(var o in t)e.push(o);x=j(e[0])||!j(e[1])?t[e[0]]:t[e[1]]}}());var z=I(x),A=x.split("-")[0];switch(z){case"top":r=i-s,n="1"==A?o:"5"===A?o-(c-a)/2:o-(c-a);break;case"right":n=o+a,r="2"==A?i:"6"===A?i-(s-f)/2:i-(s-f);break;case"bottom":r=i+f,n="4"==A?o:"7"===A?o-(c-a)/2:o-(c-a);break;case"left":n=o-c,r="1"==A?i:"8"===A?i-(s-f)/2:i-(s-f)}W.edgeAdjust&&y(x)&&("7-5"==x||"5-7"==x?n-u<.5*p?n-u<0&&(n=u):p<n-u+c&&(n=p+u-c):r-d<.5*g?r-d<0&&(r=d):g<r-d+s&&(r=g+d-s)),"top"==z||"left"==z?(n-=h,r-=l):(n+=h,r+=l),t.css({position:"absolute",left:Math.round(n),top:Math.round(r)}).attr("data-align",x),t.zIndex&&t.zIndex()}})};return function(t,e,o){e.follow(t,o)}});